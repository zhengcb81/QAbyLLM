<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼ä¸šç«äº‰åŠ›åˆ†æä»ªè¡¨æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .upload-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background-color: #f8f9ff;
        }

        .upload-area.dragover {
            border-color: #764ba2;
            background-color: #f0f4ff;
        }

        .upload-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
            transition: transform 0.2s ease;
        }

        .upload-button:hover {
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .chart-container:hover {
            transform: translateY(-5px);
        }

        .chart-container h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.2rem;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        .heatmap-container {
            height: 500px;
        }

        .info-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .info-panel h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .company-info {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .dimension-info {
            background: #fff5f5;
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid #764ba2;
        }

        .score {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .reason {
            line-height: 1.6;
            color: #555;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .data-table th,
        .data-table td {
            padding: 8px 6px;
            text-align: center;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }

        .data-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f8f9ff;
        }

        .company-name {
            font-weight: bold;
            color: #333;
            text-align: left !important;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .score-cell {
            font-weight: bold;
            min-width: 35px;
        }

        .total-score {
            background-color: #e8f4fd;
            font-weight: bold;
        }

        .avg-score {
            background-color: #f0f8ff;
            font-weight: bold;
        }

        .file-input {
            display: none;
        }

        .status-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .charts-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¢ ä¼ä¸šç«äº‰åŠ›åˆ†æä»ªè¡¨æ¿</h1>
            <p>æ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ JSONæ–‡ä»¶ï¼ŒæŸ¥çœ‹å¤šç»´åº¦ç«äº‰åŠ›åˆ†æ</p>
        </div>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div>
                    <h3>ğŸ“ ä¸Šä¼ åˆ†ææ•°æ®</h3>
                    <p>æ”¯æŒJSONæ ¼å¼æ–‡ä»¶ï¼Œæ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®é€‰æ‹©æ–‡ä»¶</p>
                    <button class="upload-button" onclick="document.getElementById('fileInput').click()">
                        é€‰æ‹©æ–‡ä»¶
                    </button>
                    <input type="file" id="fileInput" class="file-input" accept=".json" />
                </div>
            </div>
            <div id="statusMessage"></div>
        </div>

        <div class="main-content">
            <div class="charts-section">
                <div class="chart-container">
                    <h3>ğŸ“Š å¤šç»´åº¦é›·è¾¾å›¾</h3>
                    <div class="chart-wrapper">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>ğŸ“ˆ è¯„åˆ†å¯¹æ¯”æŸ±çŠ¶å›¾</h3>
                    <div class="chart-wrapper">
                        <canvas id="barChart"></canvas>
                    </div>
                </div>

                <div class="chart-container heatmap-container">
                    <h3>ğŸ”¥ è¯„åˆ†çƒ­åŠ›å›¾</h3>
                    <div class="chart-wrapper">
                        <canvas id="heatmapChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>ğŸ“‹ æ±‡æ€»æ•°æ®è¡¨</h3>
                    <div style="overflow-x: auto;">
                        <table class="data-table" id="dataTable">
                            <thead>
                                <tr>
                                    <th>å…¬å¸</th>
                                    <th>ç½‘ç»œæ•ˆåº”</th>
                                    <th>è§„æ¨¡æ•ˆåº”</th>
                                    <th>å®¢æˆ·é»æ€§</th>
                                    <th>æˆæœ¬ä¼˜åŠ¿</th>
                                    <th>ç«äº‰æ ¼å±€</th>
                                    <th>è¿›å…¥å£å’</th>
                                    <th>ä»·æ ¼æ•æ„Ÿåº¦</th>
                                    <th>æ€»åˆ†</th>
                                    <th>å¹³å‡åˆ†</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <tr>
                                    <td colspan="10" style="text-align: center; padding: 20px; color: #666;">
                                        è¯·ä¸Šä¼ JSONæ–‡ä»¶æŸ¥çœ‹æ•°æ®
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="info-panel">
                <h3>ğŸ’¡ è¯¦ç»†ä¿¡æ¯</h3>
                <div id="infoContent">
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <p>ğŸ–±ï¸ å°†é¼ æ ‡æ‚¬åœåœ¨å›¾è¡¨ä¸ŠæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
                        <p>ğŸ“Š æ”¯æŒé›·è¾¾å›¾ã€æŸ±çŠ¶å›¾ã€çƒ­åŠ›å›¾äº¤äº’</p>
                        <p>ğŸ“ ä¸Šä¼ JSONæ–‡ä»¶å¼€å§‹åˆ†æ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let globalCompanyData = [];
        let radarChart, barChart, heatmapChart;

        // é»˜è®¤ç¤ºä¾‹æ•°æ®
        const defaultData = [
            {
                "å…¬å¸å": "å°ç±³é›†å›¢",
                "ç½‘ç»œæ•ˆåº”": {"è¯„åˆ†": 8, "ç†ç”±": "å°ç±³é€šè¿‡MIUIç³»ç»Ÿå’Œç”Ÿæ€é“¾äº§å“æ„å»ºäº†å¼ºå¤§çš„ç”¨æˆ·ç½‘ç»œï¼Œç”¨æˆ·ç²˜æ€§è¾ƒé«˜ï¼Œç”Ÿæ€äº§å“é—´ååŒæ•ˆåº”æ˜æ˜¾ã€‚"},
                "è§„æ¨¡æ•ˆåº”": {"è¯„åˆ†": 9, "ç†ç”±": "å°ç±³åœ¨æ™ºèƒ½æ‰‹æœºå’ŒIoTè®¾å¤‡é¢†åŸŸå…·æœ‰æ˜¾è‘—è§„æ¨¡ä¼˜åŠ¿ï¼Œå¤§è§„æ¨¡é‡‡è´­é™ä½æˆæœ¬ï¼Œä¾›åº”é“¾è®®ä»·èƒ½åŠ›å¼ºã€‚"},
                "å®¢æˆ·é»æ€§": {"è¯„åˆ†": 7, "ç†ç”±": "MIUIç³»ç»Ÿå’Œå°ç±³ç”Ÿæ€é“¾äº§å“æä¾›äº†ä¸€å®šçš„ç”¨æˆ·ç²˜æ€§ï¼Œä½†åœ¨é«˜ç«¯å¸‚åœºç”¨æˆ·å¿ è¯šåº¦æœ‰å¾…æå‡ã€‚"},
                "æˆæœ¬ä¼˜åŠ¿": {"è¯„åˆ†": 9, "ç†ç”±": "å°ç±³ä»¥é«˜æ€§ä»·æ¯”è‘—ç§°ï¼Œé€šè¿‡ç²¾ç®€æ¸ é“ã€æ§åˆ¶è¥é”€æˆæœ¬ç­‰æ–¹å¼ä¿æŒæˆæœ¬ä¼˜åŠ¿ã€‚"},
                "ç«äº‰æ ¼å±€": {"è¯„åˆ†": 6, "ç†ç”±": "æ™ºèƒ½æ‰‹æœºå¸‚åœºç«äº‰æ¿€çƒˆï¼Œå°ç±³é¢ä¸´åä¸ºã€è‹¹æœã€OPPOã€vivoç­‰å¼ºåŠ²å¯¹æ‰‹çš„ç«äº‰ã€‚"},
                "è¿›å…¥å£å’": {"è¯„åˆ†": 7, "ç†ç”±": "æ™ºèƒ½æ‰‹æœºè¡Œä¸šæŠ€æœ¯é—¨æ§›è¾ƒé«˜ï¼Œéœ€è¦å¤§é‡ç ”å‘æŠ•å…¥å’Œä¾›åº”é“¾èµ„æºï¼Œä½†æ–°å“ç‰Œä»å¯èƒ½è¿›å…¥ã€‚"},
                "ä»·æ ¼æ•æ„Ÿåº¦": {"è¯„åˆ†": 8, "ç†ç”±": "å°ç±³ç”¨æˆ·å¯¹ä»·æ ¼è¾ƒä¸ºæ•æ„Ÿï¼Œé«˜æ€§ä»·æ¯”æ˜¯å…¶æ ¸å¿ƒç«äº‰åŠ›ï¼Œä»·æ ¼å˜åŠ¨å¯¹é”€é‡å½±å“è¾ƒå¤§ã€‚"}
            },
            {
                "å…¬å¸å": "åä¸º",
                "ç½‘ç»œæ•ˆåº”": {"è¯„åˆ†": 7, "ç†ç”±": "åä¸ºåœ¨ä¼ä¸šçº§å¸‚åœºå’Œ5GåŸºç¡€è®¾æ–½é¢†åŸŸå…·æœ‰å¼ºå¤§çš„ç½‘ç»œæ•ˆåº”ï¼Œä½†æ¶ˆè´¹è€…ä¸šåŠ¡ç½‘ç»œæ•ˆåº”ç›¸å¯¹è¾ƒå¼±ã€‚"},
                "è§„æ¨¡æ•ˆåº”": {"è¯„åˆ†": 9, "ç†ç”±": "åä¸ºæ˜¯å…¨çƒé¢†å…ˆçš„é€šä¿¡è®¾å¤‡åˆ¶é€ å•†ï¼Œåœ¨ç ”å‘ã€é‡‡è´­ã€åˆ¶é€ ç­‰æ–¹é¢å…·æœ‰æ˜¾è‘—è§„æ¨¡ä¼˜åŠ¿ã€‚"},
                "å®¢æˆ·é»æ€§": {"è¯„åˆ†": 8, "ç†ç”±": "ä¼ä¸šå®¢æˆ·å¯¹åä¸ºè®¾å¤‡ä¾èµ–åº¦è¾ƒé«˜ï¼Œæ›´æ¢æˆæœ¬å¤§ï¼›æ¶ˆè´¹è€…å¯¹åä¸ºå“ç‰Œå¿ è¯šåº¦ä¹Ÿè¾ƒé«˜ã€‚"},
                "æˆæœ¬ä¼˜åŠ¿": {"è¯„åˆ†": 9, "ç†ç”±": "åä¸ºé€šè¿‡å‚ç›´æ•´åˆå’Œè§„æ¨¡æ•ˆåº”å®ç°æˆæœ¬æ§åˆ¶ï¼Œè‡ªç ”èŠ¯ç‰‡ç­‰æ ¸å¿ƒæŠ€æœ¯é™ä½å¯¹å¤–ä¾èµ–ã€‚"},
                "ç«äº‰æ ¼å±€": {"è¯„åˆ†": 7, "ç†ç”±": "åœ¨é€šä¿¡è®¾å¤‡é¢†åŸŸåä¸ºé¢†å…ˆï¼Œä½†é¢ä¸´æ”¿æ²»å› ç´ å½±å“ï¼›æ¶ˆè´¹è€…ä¸šåŠ¡ç«äº‰æ¿€çƒˆã€‚"},
                "è¿›å…¥å£å’": {"è¯„åˆ†": 8, "ç†ç”±": "é€šä¿¡è®¾å¤‡è¡Œä¸šæŠ€æœ¯å£å’æé«˜ï¼Œéœ€è¦é•¿æœŸæŠ€æœ¯ç§¯ç´¯å’Œå¤§é‡ä¸“åˆ©ï¼Œè¿›å…¥é—¨æ§›å¾ˆé«˜ã€‚"},
                "ä»·æ ¼æ•æ„Ÿåº¦": {"è¯„åˆ†": 6, "ç†ç”±": "ä¼ä¸šå®¢æˆ·æ›´æ³¨é‡æŠ€æœ¯å’ŒæœåŠ¡ï¼Œä»·æ ¼æ•æ„Ÿåº¦ç›¸å¯¹è¾ƒä½ï¼›æ¶ˆè´¹è€…ä¸šåŠ¡ä»·æ ¼æ•æ„Ÿåº¦ä¸­ç­‰ã€‚"}
            },
            {
                "å…¬å¸å": "è‹¹æœ",
                "ç½‘ç»œæ•ˆåº”": {"è¯„åˆ†": 10, "ç†ç”±": "è‹¹æœç”Ÿæ€ç³»ç»Ÿå…·æœ‰æå¼ºçš„ç½‘ç»œæ•ˆåº”ï¼ŒiPhoneã€iPadã€Macã€Apple Watchç­‰è®¾å¤‡æ·±åº¦æ•´åˆï¼Œç”¨æˆ·ç²˜æ€§æé«˜ã€‚"},
                "è§„æ¨¡æ•ˆåº”": {"è¯„åˆ†": 9, "ç†ç”±": "è‹¹æœè™½ç„¶å‡ºè´§é‡ä¸æ˜¯æœ€å¤§ï¼Œä½†å•å“ä»·å€¼é«˜ï¼Œåœ¨ä¾›åº”é“¾è®®ä»·å’Œç ”å‘æ‘Šé”€æ–¹é¢å…·æœ‰ä¼˜åŠ¿ã€‚"},
                "å®¢æˆ·é»æ€§": {"è¯„åˆ†": 10, "ç†ç”±": "è‹¹æœç”¨æˆ·å¿ è¯šåº¦æé«˜ï¼Œç”Ÿæ€ç³»ç»Ÿé”å®šæ•ˆåº”å¼ºï¼Œç”¨æˆ·è½¬æ¢æˆæœ¬å¾ˆé«˜ã€‚"},
                "æˆæœ¬ä¼˜åŠ¿": {"è¯„åˆ†": 8, "ç†ç”±": "è‹¹æœé€šè¿‡è®¾è®¡ä¼˜åŒ–å’Œä¾›åº”é“¾ç®¡ç†æ§åˆ¶æˆæœ¬ï¼Œä½†é«˜ç«¯å®šä½ä½¿å…¶æˆæœ¬ç»“æ„ä¸å…¶ä»–å‚å•†ä¸åŒã€‚"},
                "ç«äº‰æ ¼å±€": {"è¯„åˆ†": 7, "ç†ç”±": "åœ¨é«˜ç«¯å¸‚åœºè‹¹æœå…·æœ‰ä¼˜åŠ¿åœ°ä½ï¼Œä½†æ•´ä½“æ™ºèƒ½æ‰‹æœºå¸‚åœºç«äº‰æ¿€çƒˆã€‚"},
                "è¿›å…¥å£å’": {"è¯„åˆ†": 9, "ç†ç”±": "è‹¹æœçš„ç”Ÿæ€ç³»ç»Ÿã€å“ç‰Œä»·å€¼ã€æŠ€æœ¯ç§¯ç´¯æ„æˆäº†æé«˜çš„è¿›å…¥å£å’ã€‚"},
                "ä»·æ ¼æ•æ„Ÿåº¦": {"è¯„åˆ†": 6, "ç†ç”±": "è‹¹æœç”¨æˆ·å¯¹ä»·æ ¼ç›¸å¯¹ä¸æ•æ„Ÿï¼Œæ›´æ³¨é‡äº§å“ä½“éªŒå’Œå“ç‰Œä»·å€¼ã€‚"}
            },
            {
                "å…¬å¸å": "ä¸‰æ˜Ÿ",
                "ç½‘ç»œæ•ˆåº”": {"è¯„åˆ†": 7, "ç†ç”±": "ä¸‰æ˜Ÿåœ¨Androidç”Ÿæ€ä¸­å…·æœ‰ä¸€å®šç½‘ç»œæ•ˆåº”ï¼ŒGalaxyç³»åˆ—äº§å“é—´æœ‰ååŒï¼Œä½†ä¸å¦‚è‹¹æœç”Ÿæ€ç´§å¯†ã€‚"},
                "è§„æ¨¡æ•ˆåº”": {"è¯„åˆ†": 9, "ç†ç”±": "ä¸‰æ˜Ÿæ˜¯å…¨çƒæœ€å¤§çš„æ™ºèƒ½æ‰‹æœºåˆ¶é€ å•†ä¹‹ä¸€ï¼Œåœ¨æ˜¾ç¤ºå±ã€å­˜å‚¨ç­‰æ ¸å¿ƒå™¨ä»¶æ–¹é¢å…·æœ‰è§„æ¨¡ä¼˜åŠ¿ã€‚"},
                "å®¢æˆ·é»æ€§": {"è¯„åˆ†": 8, "ç†ç”±": "ä¸‰æ˜Ÿåœ¨é«˜ç«¯å¸‚åœºæœ‰ä¸€å®šç”¨æˆ·å¿ è¯šåº¦ï¼ŒOne UIç³»ç»Ÿå’Œä¸‰æ˜Ÿç”Ÿæ€æä¾›äº†ç”¨æˆ·ç²˜æ€§ã€‚"},
                "æˆæœ¬ä¼˜åŠ¿": {"è¯„åˆ†": 9, "ç†ç”±": "ä¸‰æ˜Ÿå‚ç›´æ•´åˆç¨‹åº¦é«˜ï¼Œè‡ªäº§æ ¸å¿ƒå™¨ä»¶å¦‚å±å¹•ã€å­˜å‚¨ã€å¤„ç†å™¨ï¼Œæˆæœ¬æ§åˆ¶èƒ½åŠ›å¼ºã€‚"},
                "ç«äº‰æ ¼å±€": {"è¯„åˆ†": 7, "ç†ç”±": "ä¸‰æ˜Ÿåœ¨å…¨çƒæ™ºèƒ½æ‰‹æœºå¸‚åœºä»½é¢é¢†å…ˆï¼Œä½†é¢ä¸´è‹¹æœã€åä¸ºã€å°ç±³ç­‰å¼ºåŠ²ç«äº‰ã€‚"},
                "è¿›å…¥å£å’": {"è¯„åˆ†": 8, "ç†ç”±": "æ™ºèƒ½æ‰‹æœºè¡Œä¸šæŠ€æœ¯é—¨æ§›é«˜ï¼Œä¸‰æ˜Ÿåœ¨æ˜¾ç¤ºæŠ€æœ¯ã€åŠå¯¼ä½“åˆ¶é€ ç­‰æ–¹é¢çš„ä¼˜åŠ¿æ„æˆè¿›å…¥å£å’ã€‚"},
                "ä»·æ ¼æ•æ„Ÿåº¦": {"è¯„åˆ†": 6, "ç†ç”±": "ä¸‰æ˜Ÿäº§å“çº¿è¦†ç›–é«˜ä¸­ä½ç«¯ï¼Œä¸åŒç»†åˆ†å¸‚åœºä»·æ ¼æ•æ„Ÿåº¦ä¸åŒï¼Œæ•´ä½“ä¸­ç­‰æ°´å¹³ã€‚"}
            }
        ];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setupFileUpload();
            loadData(defaultData);
        });

        // æ–‡ä»¶ä¸Šä¼ è®¾ç½®
        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');

            // æ‹–æ‹½äº‹ä»¶
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
        }

        // å¤„ç†æ–‡ä»¶
        function handleFile(file) {
            if (!file.name.endsWith('.json')) {
                showStatus('è¯·é€‰æ‹©JSONæ ¼å¼æ–‡ä»¶', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    loadData(data);
                    showStatus('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼', 'success');
                } catch (error) {
                    showStatus('JSONæ–‡ä»¶æ ¼å¼é”™è¯¯ï¼š' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }

        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.innerHTML = `<div class="status-${type}">${message}</div>`;
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 3000);
        }

        // åŠ è½½æ•°æ®
        function loadData(data) {
            console.log('Loading data:', data);
            globalCompanyData = parseCompanyData(data);
            console.log('Parsed company data:', globalCompanyData);
            
            createRadarChart();
            createBarChart();
            createHeatmap();
            updateDataTable();
        }

        // è§£æå…¬å¸æ•°æ®
        function parseCompanyData(data) {
            const companies = [];
            const dimensions = ['ç½‘ç»œæ•ˆåº”', 'è§„æ¨¡æ•ˆåº”', 'å®¢æˆ·é»æ€§', 'æˆæœ¬ä¼˜åŠ¿', 'ç«äº‰æ ¼å±€', 'è¿›å…¥å£å’', 'ä»·æ ¼æ•æ„Ÿåº¦'];

            data.forEach(item => {
                const company = {
                    name: item['å…¬å¸å'] || item.company || 'æœªçŸ¥å…¬å¸',
                    scores: {},
                    reasons: {}
                };

                dimensions.forEach(dim => {
                    if (item[dim]) {
                        if (typeof item[dim] === 'object' && item[dim]['è¯„åˆ†'] !== undefined) {
                            company.scores[dim] = item[dim]['è¯„åˆ†'];
                            company.reasons[dim] = item[dim]['ç†ç”±'] || '';
                        } else if (typeof item[dim] === 'number') {
                            company.scores[dim] = item[dim];
                            company.reasons[dim] = '';
                        }
                    }
                });

                companies.push(company);
            });

            return companies;
        }

        // åˆ›å»ºé›·è¾¾å›¾
        function createRadarChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            if (radarChart) {
                radarChart.destroy();
            }

            const dimensions = ['ç½‘ç»œæ•ˆåº”', 'è§„æ¨¡æ•ˆåº”', 'å®¢æˆ·é»æ€§', 'æˆæœ¬ä¼˜åŠ¿', 'ç«äº‰æ ¼å±€', 'è¿›å…¥å£å’', 'ä»·æ ¼æ•æ„Ÿåº¦'];
            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'];

            const datasets = globalCompanyData.map((company, index) => ({
                label: company.name,
                data: dimensions.map(dim => company.scores[dim] || 0),
                borderColor: colors[index % colors.length],
                backgroundColor: colors[index % colors.length] + '20',
                pointBackgroundColor: colors[index % colors.length],
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: colors[index % colors.length]
            }));

            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: dimensions,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 10,
                            ticks: {
                                stepSize: 2
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    onHover: (event, elements) => {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const datasetIndex = element.datasetIndex;
                            const dataIndex = element.index;
                            const company = globalCompanyData[datasetIndex];
                            const dimension = dimensions[dataIndex];
                            
                            showDetailInfo(company.name, dimension, company.scores[dimension], company.reasons[dimension]);
                        }
                    }
                }
            });
        }

        // åˆ›å»ºæŸ±çŠ¶å›¾
        function createBarChart() {
            const ctx = document.getElementById('barChart').getContext('2d');
            
            if (barChart) {
                barChart.destroy();
            }

            const dimensions = ['ç½‘ç»œæ•ˆåº”', 'è§„æ¨¡æ•ˆåº”', 'å®¢æˆ·é»æ€§', 'æˆæœ¬ä¼˜åŠ¿', 'ç«äº‰æ ¼å±€', 'è¿›å…¥å£å’', 'ä»·æ ¼æ•æ„Ÿåº¦'];
            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'];

            const datasets = globalCompanyData.map((company, index) => ({
                label: company.name,
                data: dimensions.map(dim => company.scores[dim] || 0),
                backgroundColor: colors[index % colors.length] + '80',
                borderColor: colors[index % colors.length],
                borderWidth: 1
            }));

            barChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: dimensions,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    onHover: (event, elements) => {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const datasetIndex = element.datasetIndex;
                            const dataIndex = element.index;
                            const company = globalCompanyData[datasetIndex];
                            const dimension = dimensions[dataIndex];
                            
                            showDetailInfo(company.name, dimension, company.scores[dimension], company.reasons[dimension]);
                        }
                    }
                }
            });
        }

        // åˆ›å»ºçƒ­åŠ›å›¾
        function createHeatmap() {
            const canvas = document.getElementById('heatmapChart');
            const ctx = canvas.getContext('2d');
            
            // è®¾ç½®canvaså°ºå¯¸
            const container = canvas.parentElement;
            canvas.width = container.clientWidth - 20;
            canvas.height = container.clientHeight - 20;
            
            const dimensions = ['ç½‘ç»œæ•ˆåº”', 'è§„æ¨¡æ•ˆåº”', 'å®¢æˆ·é»æ€§', 'æˆæœ¬ä¼˜åŠ¿', 'ç«äº‰æ ¼å±€', 'è¿›å…¥å£å’', 'ä»·æ ¼æ•æ„Ÿåº¦'];
            const companies = globalCompanyData.map(c => c.name);
            
            const cellWidth = (canvas.width - 120) / dimensions.length;
            const cellHeight = (canvas.height - 80) / companies.length;
            
            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶çƒ­åŠ›å›¾
            companies.forEach((company, i) => {
                dimensions.forEach((dimension, j) => {
                    const score = globalCompanyData[i].scores[dimension] || 0;
                    const intensity = score / 10;
                    
                    // é¢œè‰²æ˜ å°„
                    const red = Math.floor(255 * (1 - intensity));
                    const green = Math.floor(255 * intensity);
                    const blue = 100;
                    
                    ctx.fillStyle = `rgb(${red}, ${green}, ${blue})`;
                    ctx.fillRect(100 + j * cellWidth, 40 + i * cellHeight, cellWidth - 1, cellHeight - 1);
                    
                    // ç»˜åˆ¶åˆ†æ•°
                    ctx.fillStyle = intensity > 0.5 ? 'white' : 'black';
                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(score.toString(), 100 + j * cellWidth + cellWidth/2, 40 + i * cellHeight + cellHeight/2 + 5);
                });
            });
            
            // ç»˜åˆ¶æ ‡ç­¾
            ctx.fillStyle = 'black';
            ctx.font = '14px Arial';
            ctx.textAlign = 'right';
            companies.forEach((company, i) => {
                const displayName = company.length > 8 ? company.substring(0, 8) + '...' : company;
                ctx.fillText(displayName, 95, 40 + i * cellHeight + cellHeight/2 + 5);
            });
            
            ctx.textAlign = 'center';
            dimensions.forEach((dimension, j) => {
                ctx.fillText(dimension, 100 + j * cellWidth + cellWidth/2, 30);
            });
            
            // æ·»åŠ é¼ æ ‡äº‹ä»¶
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const j = Math.floor((x - 100) / cellWidth);
                const i = Math.floor((y - 40) / cellHeight);
                
                if (i >= 0 && i < companies.length && j >= 0 && j < dimensions.length) {
                    const company = globalCompanyData[i];
                    const dimension = dimensions[j];
                    showDetailInfo(company.name, dimension, company.scores[dimension], company.reasons[dimension]);
                }
            });
        }

        // æ›´æ–°æ•°æ®è¡¨
        function updateDataTable() {
            const tableBody = document.getElementById('tableBody');
            const dimensions = ['ç½‘ç»œæ•ˆåº”', 'è§„æ¨¡æ•ˆåº”', 'å®¢æˆ·é»æ€§', 'æˆæœ¬ä¼˜åŠ¿', 'ç«äº‰æ ¼å±€', 'è¿›å…¥å£å’', 'ä»·æ ¼æ•æ„Ÿåº¦'];
            
            tableBody.innerHTML = '';
            
            globalCompanyData.forEach(company => {
                const row = document.createElement('tr');
                
                // å…¬å¸åç§°
                const nameCell = document.createElement('td');
                nameCell.className = 'company-name';
                nameCell.textContent = company.name;
                row.appendChild(nameCell);
                
                // å„ç»´åº¦è¯„åˆ†
                let totalScore = 0;
                let validScores = 0;
                
                dimensions.forEach(dim => {
                    const cell = document.createElement('td');
                    cell.className = 'score-cell';
                    const score = company.scores[dim] || 0;
                    cell.textContent = score;
                    if (score > 0) {
                        totalScore += score;
                        validScores++;
                    }
                    row.appendChild(cell);
                });
                
                // æ€»åˆ†
                const totalCell = document.createElement('td');
                totalCell.className = 'score-cell total-score';
                totalCell.textContent = totalScore;
                row.appendChild(totalCell);
                
                // å¹³å‡åˆ†
                const avgCell = document.createElement('td');
                avgCell.className = 'score-cell avg-score';
                avgCell.textContent = validScores > 0 ? (totalScore / validScores).toFixed(1) : '0';
                row.appendChild(avgCell);
                
                tableBody.appendChild(row);
            });
        }

        // æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
        function showDetailInfo(companyName, dimension, score, reason) {
            const infoContent = document.getElementById('infoContent');
            infoContent.innerHTML = `
                <div class="company-info">
                    <h4>ğŸ¢ ${companyName}</h4>
                    <p><strong>ç»´åº¦ï¼š</strong>${dimension}</p>
                </div>
                <div class="dimension-info">
                    <div class="score">ğŸ“Š è¯„åˆ†ï¼š${score}/10</div>
                    <div class="reason">
                        <strong>ğŸ’¡ åˆ†æç†ç”±ï¼š</strong><br>
                        ${reason || 'æš‚æ— è¯¦ç»†ç†ç”±'}
                    </div>
                </div>
            `;
        }

        // çª—å£å¤§å°å˜åŒ–æ—¶é‡ç»˜çƒ­åŠ›å›¾
        window.addEventListener('resize', () => {
            if (globalCompanyData.length > 0) {
                setTimeout(createHeatmap, 100);
            }
        });
    </script>
</body>
</html> 